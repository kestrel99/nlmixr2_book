<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Nonlinear mixed-effects modelling with nlmixr2 - 1&nbsp; Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./history.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Nonlinear mixed-effects modelling with nlmixr2</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/kestrel99/nlmixr2_book/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./history.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">History</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#pharmacometrics" id="toc-pharmacometrics" class="nav-link active" data-scroll-target="#pharmacometrics"><span class="toc-section-number">1.1</span>  Pharmacometrics</a></li>
  <li><a href="#nlmixr2" id="toc-nlmixr2" class="nav-link" data-scroll-target="#nlmixr2"><span class="toc-section-number">1.2</span>  <code>nlmixr2</code></a></li>
  <li><a href="#what-you-will-learn" id="toc-what-you-will-learn" class="nav-link" data-scroll-target="#what-you-will-learn"><span class="toc-section-number">1.3</span>  What you will learn</a></li>
  <li><a href="#how-this-book-is-organised" id="toc-how-this-book-is-organised" class="nav-link" data-scroll-target="#how-this-book-is-organised"><span class="toc-section-number">1.4</span>  How this book is organised</a></li>
  <li><a href="#what-you-wont-learn" id="toc-what-you-wont-learn" class="nav-link" data-scroll-target="#what-you-wont-learn"><span class="toc-section-number">1.5</span>  What you won’t learn</a>
  <ul class="collapse">
  <li><a href="#pharmacology" id="toc-pharmacology" class="nav-link" data-scroll-target="#pharmacology"><span class="toc-section-number">1.5.1</span>  Pharmacology</a></li>
  <li><a href="#pharmacometrics-1" id="toc-pharmacometrics-1" class="nav-link" data-scroll-target="#pharmacometrics-1"><span class="toc-section-number">1.5.2</span>  Pharmacometrics</a></li>
  <li><a href="#big-data" id="toc-big-data" class="nav-link" data-scroll-target="#big-data"><span class="toc-section-number">1.5.3</span>  Big data</a></li>
  <li><a href="#data-science" id="toc-data-science" class="nav-link" data-scroll-target="#data-science"><span class="toc-section-number">1.5.4</span>  Data science</a></li>
  <li><a href="#pythonjuliamatlabsasruby-on-railsetc" id="toc-pythonjuliamatlabsasruby-on-railsetc" class="nav-link" data-scroll-target="#pythonjuliamatlabsasruby-on-railsetc"><span class="toc-section-number">1.5.5</span>  Python/Julia/Matlab/SAS/Ruby on Rails/etc</a></li>
  </ul></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites"><span class="toc-section-number">1.6</span>  Prerequisites</a>
  <ul class="collapse">
  <li><a href="#r" id="toc-r" class="nav-link" data-scroll-target="#r"><span class="toc-section-number">1.6.1</span>  R</a></li>
  <li><a href="#rstudio" id="toc-rstudio" class="nav-link" data-scroll-target="#rstudio"><span class="toc-section-number">1.6.2</span>  RStudio</a></li>
  <li><a href="#nlmixr2-and-friends" id="toc-nlmixr2-and-friends" class="nav-link" data-scroll-target="#nlmixr2-and-friends"><span class="toc-section-number">1.6.3</span>  <code>nlmixr2</code> and friends</a></li>
  </ul></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements"><span class="toc-section-number">1.7</span>  Acknowledgements</a></li>
  <li><a href="#colophon" id="toc-colophon" class="nav-link" data-scroll-target="#colophon"><span class="toc-section-number">1.8</span>  Colophon</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="pharmacometrics" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="pharmacometrics"><span class="header-section-number">1.1</span> Pharmacometrics</h2>
<p>Wikipedia defines pharmacometrics (PMx) as a field of study of the methodology and application of mathematical models for disease and pharmacological measurement. It applies mathematical models of biology, pharmacology, disease, and physiology to describe and quantify interactions between xenobiotics (drugs) and patients (human and non-human), including both beneficial and adverse effects. It is normally applied to combine data from drugs, diseases and clinical trials to aid efficient drug development, regulatory decisions and rational drug treatment in patients.</p>
<p>Pharmacometrics rolls up modeling and simulation for pharmacokinetics, pharmacodynamics, and #DiseaseProgression, with a focus on populations and variability. A major focus is to understand variability in drug response, which can be predictable (e.g.&nbsp;due to differences in body weight or kidney function) or unpredictable (differences between subjects seem random, but likely reflect a lack of knowledge or data).</p>
<p>Quantitative systems pharmacology (QSP) is also considered to be a part of the PMx ecosystem, but applies a more theoretical and less data-driven approach to building models. QSP models are often much more complex than PK/PD models, with less of a populations focus.</p>
<p>What this boils down to is using mathematical/statistical models to help explain and predict what the body does to the drug (pharmacokinetics, PK) and what the drug does to the body (pharmacodynamics, PD) - these are often combined to produce PKPD or exposure-response (ER) models. We build these using data collected from clinical trials (e.g.&nbsp;blood samples, clinical observations, scores, X-rays and suchlike - multiple samples, over time, from many subjects), which we use to build compartmental models which approximate what is happening over time using ordinary differential equations (ODEs).</p>
<p>This sounds complicated - and it can be - but it’s based on the well-stirred compartmental model for PK, a well-established set of principles for how systems like these can be approximated.</p>
<p>I promised you beer! It’s actually a pretty good example. PK describes what happens to the alcohol (ethanol) you consume between the glass and the bathroom, and PD describes what it does while it’s circulating in your blood (quite a few things, including making you tipsy). Ethanol is a pretty interesting case, because it’s eye-wateringly complex. The “DrinkMe” simulation on Nick Holford’s website is a fun interactive example of how it fits together! You can find it at http://holford.fmhs.auckland.ac.nz/research/ethanol.</p>
<p>So pharmacometrics can help us understand how drugs behave in different people. The “DrinkMe” model includes body weight - the bigger you are, the bigger your organs are (usually) and the more machinery you have for metabolizing substances like ethanol, so the slower you get drunk, and if you’ve eaten something, the alcohol will take longer to get into your system (although these are just two aspects of a very complex system).</p>
<p>These principles apply to every drug we take, from aspirin to metformin (which is commonly used for treating diabetes). We use these models to figure out what an appropriate dose is, and what might affect it.</p>
<p>We can use pharmacometric models like these to simulate clinical trials, dose regimens and so on, <em>in silico</em>, so that we can predict what will happen when we actually give a drug to a human, and whether the design we have proposed for our clinical trial will actually work when we run it.</p>
<p>Later on in drug development, as we get close to registration, we can use these models to identify covariates whcih might inform differences in exposure and effect between patients (like age, weight, and sex), and to quantify the relationships between dose, exposure, and response for efficacy (e.g.&nbsp;how well the drug does at reducing or eliminating a tumour) and safety (e.g.&nbsp;how many unwanted side effects the drug generates at a useful dose).</p>
<p>It’s not just about the drugs themselves. Drug-disease and disease progression models are also an area in which pharmacometrics continues to have an impact - FDA maintains a list the ones they’ve developed internally (https://www.fda.gov/about-fda/center-drug-evaluation-and-research-cder/division-pharmacometrics), including examples for Alzheimer’s disease and diabetes, although there are many, many more.</p>
<p>So far we’ve mostly talked about empirical, data-driven models, but pharmacometrics goes further, especially now that the computers are getting so fast (models take time to fit to data, and the more complex they are, and the more patients you have, the longer they take).</p>
<p>Physiologically-based PK (PBPK) models, for example, find the middle ground between PK and QSP, having a more mechanistic bent by taking into account anatomical, physiological, physical, and chemical descriptions of the phenomena involved in complex absorption, distribution, metabolic and elimination (ADME) processes, while remaining fundamentally driven by observed data.</p>
</section>
<section id="nlmixr2" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="nlmixr2"><span class="header-section-number">1.2</span> <code>nlmixr2</code></h2>
<p><code>nlmixr2</code> is a set of packages - let’s call it the “mixrverse” - for R that provides an open source alternative for nonlinear mixed-effects (NLME) model development, which are the core of most pharmacometrics workflows (amongst others).</p>
<p>Modeling tools in our area are largely closed-source and massively expensive, and are a gigantic entry barrier for new people, especially in low and middle-income countries (and borderline unaffordable even for CROs like mine). <code>nlmixr2</code> is intended to be a solution to this problem.</p>
</section>
<section id="what-you-will-learn" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="what-you-will-learn"><span class="header-section-number">1.3</span> What you will learn</h2>
<p>This book is intended to be a guide to using <code>nlmixr2</code> and its constellation of supporting and allied packages in R to develop and use nonlinear mixed-effect pharmacometric models. It is not going to teach you pharmacology, or the core tenets of pharmacometrics. You can learn about those elsewhere.</p>
<p>You will, however, learn to construct datasets for analysis, to write models in <code>rxode2</code> and <code>nlmixr2</code>, to fit them using <code>nlmixr2</code>, to use <code>shinyMixR</code> for tracking model development steps, to use <code>xpose.nlmixr2</code> for model evaluation, to use <code>babelmixr2</code> to cross-convert models from different tools, and to use <code>PKNCA</code> for figuring out initial estimates. You’ll also learn how the “mixrverse” ecosystem has been constructed and how to work with it efficiently.</p>
<p>Throughout the book, we’ll point you to resources where you can learn more.</p>
</section>
<section id="how-this-book-is-organised" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="how-this-book-is-organised"><span class="header-section-number">1.4</span> How this book is organised</h2>
<p>We start off with a summary of <code>nlmixr2</code> and all its dependencies, and how they’re built and work together. This is essential for understanding why things have been set up in the way they have, and how to drill down into the source code to figure out what is actually happening under the hood. It is not, however, essential if you want to dive straight into modeling.</p>
<p>We then get into datasets - how they should be structured, how events like doses are handled, visualization, and what variables should be.</p>
<p>Next up, we look at a simple PK model, to illustrate how models can be written - both with closed-form solutions and ODEs - as well as how <code>nlmixr2</code> objects are constructed, and how to extract information from them. We’ll use this example to explore the various minimization algorithms that are available and how to tune them.</p>
<p>We’ll then move on to a more complex PK example, to illustrate some of <code>nlmixr2</code>’s niftier features, like transit absorption models, and how to use the various diagnostics that are available, as well as <code>shinyMixR</code>. We’ll then segue into simulation (using <code>rxode2</code>) to see how pharmacometric models can be used to predict clinical trial outcomes, for example.</p>
<p>PK/PD models will be demonstrated using a version of the legendary haematological toxicity (“hemtox”) model, along with a practical demonstration of how it can be used to predict neutropenia rates.</p>
<p>Finally, we’ll wrap up with a demonstration of using <code>babelmixr</code> to import models from NONMEM, and <code>PKNCA</code> for providing credible initial estimates, and some guidelines on how you can contribute to the project if you so wish. <code>nlmixr2</code> is, after all, an open-source project and relies entirely on volunteers for its development and maintenance.</p>
<p>Within each chapter, we try and adhere to a similar pattern: start with some motivating examples so you can see the bigger picture, and then dive into the details. Each section of the book is paired with exercises to help you practice what you’ve learned.</p>
<p>Although it can be tempting to skip the exercises, there’s no better way to learn than practicing on real problems.</p>
</section>
<section id="what-you-wont-learn" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="what-you-wont-learn"><span class="header-section-number">1.5</span> What you won’t learn</h2>
<p>There are some topics that this book doesn’t cover, simply because there isn’t space.</p>
<section id="pharmacology" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="pharmacology"><span class="header-section-number">1.5.1</span> Pharmacology</h3>
<p>This is quite a big one. You can’t be an effective pharmacometrician unless you’re up to speed with basic pharmacology, which you can’t pick up in an afternoon. We’ll be touching on pharmacology concepts throughout, but we’re assuming you already know the theory. There are quite a few good books that can serve as an introduction to the topic - we particularly like Rowland &amp; Tozer <span class="citation" data-cites="derendorf_rowland_2019">(<a href="references.html#ref-derendorf_rowland_2019" role="doc-biblioref">1</a>)</span>.</p>
</section>
<section id="pharmacometrics-1" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="pharmacometrics-1"><span class="header-section-number">1.5.2</span> Pharmacometrics</h3>
<p>Even bigger. Although you’ll be able to infer a lot of things as we go, it would help if you already know what compartmental nonlinear mixed-effects models are and how they can be used to model the behaviour of drugs. Mould &amp; Upton published a nice overview of the field a decade or so ago <span class="citation" data-cites="Mould2012 Mould2013 Upton2014">(<a href="references.html#ref-Mould2012" role="doc-biblioref">2</a>–<a href="references.html#ref-Upton2014" role="doc-biblioref">4</a>)</span>, and there are good textbooks as well <span class="citation" data-cites="ette_pharmacometrics_2007 gabrielsson_pharmacokinetic_2007">(<a href="references.html#ref-ette_pharmacometrics_2007" role="doc-biblioref">5</a>,<a href="references.html#ref-gabrielsson_pharmacokinetic_2007" role="doc-biblioref">6</a>)</span>.</p>
</section>
<section id="big-data" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="big-data"><span class="header-section-number">1.5.3</span> Big data</h3>
<p>This book assumes you’re working with relatively small in-memory datasets. The kinds of models we talk about here don’t work well with bigger ones.</p>
</section>
<section id="data-science" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="data-science"><span class="header-section-number">1.5.4</span> Data science</h3>
<p>We are dealing with specifically pharmacometric data analysis round these parts. If it’s pure data science you’re interested in, we heartily recommend <a href="https://github.com/hadley/r4ds/">R for Data Science</a>, which provides a comprehensive grounding. (We also swiped its structure for our book, which is a compliment of a sort, we guess.)</p>
</section>
<section id="pythonjuliamatlabsasruby-on-railsetc" class="level3" data-number="1.5.5">
<h3 data-number="1.5.5" class="anchored" data-anchor-id="pythonjuliamatlabsasruby-on-railsetc"><span class="header-section-number">1.5.5</span> Python/Julia/Matlab/SAS/Ruby on Rails/etc</h3>
<p>In this book, you won’t learn anything about Python, Julia, JavaScript or any other language outside of R. This is because <code>nlmixr2</code> is written in R.</p>
<p>R is an environment designed from the ground up to support quantitative science, being not just a programming language, but also an interactive environment. It is - in our opinion - a much more flexible language than many of its peers.</p>
</section>
</section>
<section id="prerequisites" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="prerequisites"><span class="header-section-number">1.6</span> Prerequisites</h2>
<p>There’s some things we assume you know to get the most out of this book. We expect you to know your way around numbers and math, and to have at least basic experience with programming in R. If you’re new to R programming, <a href="https://rstudio-education.github.io/hopr/">Hands on Programming with R</a> is a highly-recommended place to start.</p>
<p>You need a computer running a recent version of Windows, macOS or Linux with a decent amount of RAM, and some software.</p>
<section id="r" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="r"><span class="header-section-number">1.6.1</span> R</h3>
<p>R is free and open source, and can be freely downloaded from CRAN, the <strong>c</strong>omprehensive <strong>R</strong> <strong>a</strong>rchive <strong>n</strong>etwork. CRAN is composed of a vast collection of mirrored servers located around the world and is used to distribute R and R packages. Rather than trying to pick the nearest server, use the cloud mirror, <a href="https://cloud.r-project.org" class="uri">https://cloud.r-project.org</a>, which automatically does the heavy lifting for you. New major releases come once a year, interspersed with 2-3 minor releases. It’s a good idea to keep current, but we know that people in the pharma industry aren’t necessarily able to do this. That being said, you need version 4.2.2 or better for this book.</p>
</section>
<section id="rstudio" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="rstudio"><span class="header-section-number">1.6.2</span> RStudio</h3>
<p>RStudio is an integrated development environment, or IDE, for R and Python. You can get it from <a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a>. You’ll need at least version 2022.07.2+576.</p>
</section>
<section id="nlmixr2-and-friends" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="nlmixr2-and-friends"><span class="header-section-number">1.6.3</span> <code>nlmixr2</code> and friends</h3>
<p>It goes without saying that you’ll need to install some additional R packages. An R package is, essentially, a bundle of functions, data, and documentation that can be added to base R to extend its capabilities. As of today, there are tens of thousands of them.</p>
<p>Install <code>nlmixr2</code> and its many dependencies from CRAN by entering the following code into R (or RStudio):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"nlmixr2"</span>,<span class="st">"sessioninfo"</span>,<span class="st">"pmxTools"</span>,<span class="st">"PKNCA"</span>,<span class="st">"babelmixr2"</span>,<span class="st">"xpose.nlmixr2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once installed, it can be loaded as follows. Note that you can’t use it until it’s been loaded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlmixr2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlmixr2data</code></pre>
</div>
</div>
</section>
</section>
<section id="acknowledgements" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="acknowledgements"><span class="header-section-number">1.7</span> Acknowledgements</h2>
<p>We have a lot of people to thank. <code>nlmixr2</code> is the product of countless hours of hard work by many, many contributors.</p>
<p>First and foremost, Wenping Wang is in many ways the father of <code>nlmixr</code>. It was his work that provided the foundation for this tool, and although he has since moved on from the core development team, everything we’ve built started with him.</p>
<p>Teun Post was there at the very beginning, and was responsible for a lot of the initial documentation for <code>nlmixr</code>. Although he too has moved on, his contribution was large and fundamental.</p>
<p>The <code>nlmixr</code> project has relied heavily on support from our day jobs. Matt, Mirjam, Yuan, Huijuan and Wenping were given the time they needed to work on this project by Novartis, which remains an enthusiastic core sponsor of the team and the project. Mick Looby, Lisa Hendricks and Etienne Pigeolet are worthy of special mention here. Justin and Rik have had their time sponsored by Occams, Richard and Teun were and are supported by LAP&amp;P, Johnson &amp; Johnson, Seattle Genetics, Avrobio, Human Predictions and Certara have all donated their associates’ time to help us build this tool. We are grateful to all of them.</p>
<p>Without <code>RxODE</code>, there would be no <code>nlmixr</code>. We would be remiss in not mentioning the early contributions of Melissa Hallow, David James and Wenping in the development of this, the engine that drives <code>nlmixr</code> and <code>nlmixr2</code>.</p>
<p>We’d all like to thank our families and colleagues for putting up with the odd hours and late nights and copious amounts of swearing emanating from our offices, both at work, and more often, recently, at home.</p>
<p>Those we’re most grateful to, though, are our users: the early adopters, the curious, and most importantly, the bug reporters who have put <code>nlmixr</code> through its paces over the years and helped it become what it is today. Thank you, and we hope you’ll stay with us as we grow.</p>
</section>
<section id="colophon" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="colophon"><span class="header-section-number">1.8</span> Colophon</h2>
<p>This book is powered by <a href="https://quarto.org">Quarto</a> which makes it easy to write books that combine text and executable code.</p>
<p>This book was built with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="fu">c</span>(<span class="st">"nlmixr2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.2 (2022-10-31 ucrt)
 os       Windows 10 x64 (build 22621)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  English_World.utf8
 ctype    English_World.utf8
 tz       Europe/Berlin
 date     2023-01-30
 pandoc   2.19.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 !  package       * version     date (UTC) lib source
    askpass         1.1         2019-01-13 [1] CRAN (R 4.2.2)
    assertthat      0.2.1       2019-03-21 [1] CRAN (R 4.2.2)
 P  backports       1.4.1       2021-12-13 [?] CRAN (R 4.2.0)
    base64enc       0.1-3       2015-07-28 [1] CRAN (R 4.2.0)
    BH              1.78.0-0    2021-12-15 [1] CRAN (R 4.2.0)
    binom           1.1-1.1     2022-05-02 [1] CRAN (R 4.2.2)
    bit             4.0.4       2020-08-04 [1] CRAN (R 4.2.2)
    bit64           4.0.5       2020-08-30 [1] CRAN (R 4.2.2)
    bitops          1.0-7       2021-04-24 [1] CRAN (R 4.2.0)
    boot            1.3-28      2021-05-03 [1] CRAN (R 4.2.2)
 P  cachem          1.0.6       2021-08-19 [?] CRAN (R 4.2.2)
    cellranger      1.1.0       2016-07-27 [1] CRAN (R 4.2.2)
 P  checkmate       2.1.0       2022-04-21 [?] CRAN (R 4.2.2)
    class           7.3-20      2022-01-16 [1] CRAN (R 4.2.2)
    classInt        0.4-8       2022-09-29 [1] CRAN (R 4.2.2)
 P  cli             3.4.1       2022-09-23 [?] CRAN (R 4.2.2)
    clipr           0.8.0       2022-02-22 [1] CRAN (R 4.2.2)
    cluster         2.1.4       2022-08-22 [1] CRAN (R 4.2.2)
 P  colorspace      2.0-3       2022-02-21 [?] CRAN (R 4.2.2)
    commonmark      1.8.1       2022-10-14 [1] CRAN (R 4.2.2)
    cpp11           0.4.3       2022-10-12 [1] CRAN (R 4.2.2)
    crayon          1.5.2       2022-09-29 [1] CRAN (R 4.2.2)
    curl            4.3.3       2022-10-06 [1] CRAN (R 4.2.2)
 P  data.table      1.14.4      2022-10-17 [?] CRAN (R 4.2.2)
    deldir          1.0-6       2021-10-23 [1] CRAN (R 4.2.1)
    Deriv           4.1.3       2021-02-24 [1] CRAN (R 4.2.2)
    DescTools       0.99.47     2022-10-22 [1] CRAN (R 4.2.2)
 P  digest          0.6.30      2022-10-18 [?] CRAN (R 4.2.2)
 P  dparser         1.3.1-9     2022-11-10 [?] CRAN (R 4.2.2)
 P  dplyr           1.0.10      2022-09-01 [?] CRAN (R 4.2.2)
    e1071           1.7-12      2022-10-24 [1] CRAN (R 4.2.2)
    ellipsis        0.3.2       2021-04-29 [1] CRAN (R 4.2.2)
 P  evaluate        0.17        2022-10-07 [?] CRAN (R 4.2.2)
    Exact           3.2         2022-09-25 [1] CRAN (R 4.2.1)
    expm            0.999-6     2021-01-13 [1] CRAN (R 4.2.2)
 P  fansi           1.0.3       2022-03-24 [?] CRAN (R 4.2.2)
    farver          2.1.1       2022-07-06 [1] CRAN (R 4.2.2)
 P  fastmap         1.1.0       2021-01-25 [?] CRAN (R 4.2.2)
    foreign         0.8-83      2022-09-28 [1] CRAN (R 4.2.2)
    Formula         1.2-4       2020-10-16 [1] CRAN (R 4.2.0)
 P  generics        0.1.3       2022-07-05 [?] CRAN (R 4.2.2)
 P  ggplot2         3.4.0       2022-11-04 [?] CRAN (R 4.2.2)
    ggtext          0.1.2       2022-09-16 [1] CRAN (R 4.2.2)
    gld             2.6.6       2022-10-23 [1] CRAN (R 4.2.2)
 P  glue            1.6.2       2022-02-24 [?] CRAN (R 4.2.2)
    gridExtra       2.3         2017-09-09 [1] CRAN (R 4.2.2)
    gridtext        0.1.5       2022-09-16 [1] CRAN (R 4.2.2)
 P  gtable          0.3.1       2022-09-01 [?] CRAN (R 4.2.2)
    highr           0.9         2021-04-16 [1] CRAN (R 4.2.2)
    Hmisc           4.7-1       2022-08-15 [1] CRAN (R 4.2.2)
    hms             1.1.2       2022-08-19 [1] CRAN (R 4.2.2)
    htmlTable       2.4.1       2022-07-07 [1] CRAN (R 4.2.2)
 P  htmltools       0.5.3       2022-07-18 [?] CRAN (R 4.2.2)
 P  htmlwidgets     1.5.4       2021-09-08 [?] CRAN (R 4.2.2)
    httr            1.4.4       2022-08-17 [1] CRAN (R 4.2.2)
    inline          0.3.19      2021-05-31 [1] CRAN (R 4.2.2)
    interp          1.1-3       2022-07-13 [1] CRAN (R 4.2.2)
    isoband         0.2.6       2022-10-06 [1] CRAN (R 4.2.2)
    jpeg            0.1-9       2021-07-24 [1] CRAN (R 4.2.0)
 P  jsonlite        1.8.3       2022-10-21 [?] CRAN (R 4.2.2)
    KernSmooth      2.23-20     2021-05-03 [1] CRAN (R 4.2.2)
 P  knitr           1.40        2022-08-24 [?] CRAN (R 4.2.2)
    labeling        0.4.2       2020-10-20 [1] CRAN (R 4.2.0)
 P  lattice         0.20-45     2021-09-22 [?] CRAN (R 4.2.2)
    latticeExtra    0.6-30      2022-07-04 [1] CRAN (R 4.2.2)
    lazyeval        0.2.2       2019-03-15 [1] CRAN (R 4.2.2)
 P  lbfgsb3c        2020-3.2    2020-03-03 [?] CRAN (R 4.2.2)
 P  lifecycle       1.0.3       2022-10-07 [?] CRAN (R 4.2.2)
    lmom            2.9         2022-05-29 [1] CRAN (R 4.2.0)
 P  lotri           0.4.2       2022-06-18 [?] CRAN (R 4.2.2)
 P  magrittr        2.0.3       2022-03-30 [?] CRAN (R 4.2.2)
    markdown        1.3         2022-10-29 [1] CRAN (R 4.2.2)
    MASS            7.3-58.1    2022-08-03 [1] CRAN (R 4.2.2)
    Matrix          1.5-1       2022-09-13 [1] CRAN (R 4.2.2)
 P  memoise         2.0.1       2021-11-26 [?] CRAN (R 4.2.2)
    mgcv            1.8-41      2022-10-21 [1] CRAN (R 4.2.2)
    mime            0.12        2021-09-28 [1] CRAN (R 4.2.0)
    minpack.lm      1.2-2       2022-04-13 [1] CRAN (R 4.2.2)
    minqa           1.2.5       2022-10-19 [1] CRAN (R 4.2.2)
 P  munsell         0.5.0       2018-06-12 [?] CRAN (R 4.2.2)
    mvtnorm         1.1-3       2021-10-08 [1] CRAN (R 4.2.0)
 P  n1qn1           6.0.1-11    2022-10-18 [?] CRAN (R 4.2.2)
 P  nlme            3.1-160     2022-10-10 [?] CRAN (R 4.2.2)
 P  nlmixr2       * 2.0.8       2022-10-23 [?] CRAN (R 4.2.2)
 P  nlmixr2data   * 2.0.7       2022-04-22 [?] CRAN (R 4.2.0)
 P  nlmixr2est      2.1.2       2022-11-03 [?] https://nlmixr2.r-universe.dev (R 4.2.2)
    nlmixr2extra    2.0.8       2022-10-22 [1] CRAN (R 4.2.2)
 P  nlmixr2plot     2.0.7       2022-10-20 [?] CRAN (R 4.2.2)
    nnet            7.3-18      2022-09-28 [1] CRAN (R 4.2.2)
    numDeriv        2016.8-1.1  2019-06-06 [1] CRAN (R 4.2.0)
    openssl         2.0.4       2022-10-17 [1] CRAN (R 4.2.2)
    optextras       2019-12.4   2019-12-20 [1] CRAN (R 4.2.0)
    pander          0.6.5       2022-03-18 [1] CRAN (R 4.2.2)
 P  pillar          1.8.1       2022-08-19 [?] CRAN (R 4.2.2)
 P  pkgconfig       2.0.3       2019-09-22 [?] CRAN (R 4.2.2)
    png             0.1-7       2013-12-03 [1] CRAN (R 4.2.0)
 P  PreciseSums     0.5         2022-04-22 [?] CRAN (R 4.2.2)
    prettyunits     1.1.1       2020-01-24 [1] CRAN (R 4.2.2)
    progress        1.2.2       2019-05-16 [1] CRAN (R 4.2.2)
    proxy           0.4-27      2022-06-09 [1] CRAN (R 4.2.2)
    purrr           0.3.5       2022-10-06 [1] CRAN (R 4.2.2)
 P  qs              0.25.4      2022-08-09 [?] CRAN (R 4.2.2)
 P  R6              2.5.1       2021-08-19 [?] CRAN (R 4.2.2)
 P  RApiSerialize   0.1.2       2022-08-25 [?] CRAN (R 4.2.1)
    RColorBrewer    1.1-3       2022-04-03 [1] CRAN (R 4.2.0)
 P  Rcpp            1.0.9       2022-07-08 [?] CRAN (R 4.2.2)
    RcppArmadillo   0.11.4.0.1  2022-10-02 [1] CRAN (R 4.2.2)
    RcppEigen       0.3.3.9.2   2022-04-08 [1] CRAN (R 4.2.2)
 PD RcppParallel    5.1.5       2022-01-05 [?] CRAN (R 4.2.2)
    RCurl           1.98-1.9    2022-10-03 [1] CRAN (R 4.2.1)
    readr           2.1.3       2022-10-01 [1] CRAN (R 4.2.2)
    readxl          1.4.1       2022-08-17 [1] CRAN (R 4.2.2)
    rematch         1.0.1       2016-04-21 [1] CRAN (R 4.2.2)
    rex             1.2.1       2021-11-26 [1] CRAN (R 4.2.2)
 P  rlang           1.0.6       2022-09-24 [?] CRAN (R 4.2.2)
    rootSolve       1.8.2.3     2021-09-29 [1] CRAN (R 4.2.0)
    rpart           4.1.19      2022-10-21 [1] CRAN (R 4.2.2)
 P  rstudioapi      0.14        2022-08-22 [?] CRAN (R 4.2.2)
    Rvmmin          2018-4.17.1 2021-04-18 [1] CRAN (R 4.2.2)
 P  rxode2          2.0.11      2022-11-01 [?] CRAN (R 4.2.2)
 P  rxode2et        2.0.9.9000  2022-10-25 [?] https://nlmixr2.r-universe.dev (R 4.2.1)
    rxode2ll        2.0.9.9000  2022-10-20 [1] https://nlmixr2.r-universe.dev (R 4.2.1)
 P  rxode2parse     2.0.13      2022-11-10 [?] CRAN (R 4.2.2)
 P  rxode2random    2.0.9       2022-10-11 [?] CRAN (R 4.2.2)
 P  scales          1.2.1       2022-08-20 [?] CRAN (R 4.2.2)
    sitmo           2.0.2       2021-10-13 [1] CRAN (R 4.2.2)
    StanHeaders     2.21.0-7    2020-12-17 [1] CRAN (R 4.2.2)
 P  stringfish      0.15.7      2022-04-13 [?] CRAN (R 4.2.2)
 P  stringi         1.7.8       2022-07-11 [?] CRAN (R 4.2.1)
 P  stringr         1.4.1       2022-08-20 [?] CRAN (R 4.2.2)
    survival        3.4-0       2022-08-09 [1] CRAN (R 4.2.2)
 P  symengine       0.2.2       2022-10-23 [?] CRAN (R 4.2.2)
 P  sys             3.4.1       2022-10-18 [?] CRAN (R 4.2.2)
 P  tibble          3.1.8       2022-07-22 [?] CRAN (R 4.2.2)
    tidyr           1.2.1       2022-09-08 [1] CRAN (R 4.2.2)
 P  tidyselect      1.2.0       2022-10-10 [?] CRAN (R 4.2.2)
    tzdb            0.3.0       2022-03-28 [1] CRAN (R 4.2.2)
    ucminf          1.1-4.1     2022-09-29 [1] CRAN (R 4.2.1)
 P  utf8            1.2.2       2021-07-24 [?] CRAN (R 4.2.2)
 P  vctrs           0.5.0       2022-10-22 [?] CRAN (R 4.2.2)
    viridis         0.6.2       2021-10-13 [1] CRAN (R 4.2.2)
    viridisLite     0.4.1       2022-08-22 [1] CRAN (R 4.2.2)
 P  vpc             1.2.2       2021-01-11 [?] CRAN (R 4.2.2)
    vroom           1.6.0       2022-09-30 [1] CRAN (R 4.2.2)
    withr           2.5.0       2022-03-03 [1] CRAN (R 4.2.2)
 P  xfun            0.34        2022-10-18 [?] CRAN (R 4.2.2)
    xgxr            1.1.1       2021-04-22 [1] CRAN (R 4.2.2)
    xml2            1.3.3       2021-11-30 [1] CRAN (R 4.2.2)
 P  yaml            2.3.6       2022-10-18 [?] CRAN (R 4.2.1)

 [1] C:/Occams/Local/GitHub/nlmixr2_book/renv/library/R-4.2/x86_64-w64-mingw32
 [2] C:/Users/justin/AppData/Local/Temp/Rtmp8MtPko/renv-system-library

 P ── Loaded and on-disk path mismatch.
 D ── DLL MD5 mismatch, broken installation.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>


<div id="refs" class="references csl-bib-body" role="doc-bibliography" style="display: none">
<div id="ref-derendorf_rowland_2019" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Derendorf H, Schmidt S. Rowland and <span>Tozer</span>’s <span>Clinical</span> <span>Pharmacokinetics</span> and <span>Pharmacodynamics</span>: <span>Concepts</span> and <span>Applications</span>. Wolters Kluwer; 2019. </div>
</div>
<div id="ref-Mould2012" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Mould DR, Upton RN. <a href="https://doi.org/10.1038/psp.2012.4"><span class="nocase">Basic Concepts in Population Modeling, Simulation, and Model-Based Drug Development</span></a>. CPT: Pharmacometrics &amp; Systems Pharmacology. 2012;1(9):e6. </div>
</div>
<div id="ref-Mould2013" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Mould DR, Upton RN. <a href="https://doi.org/10.1038/PSP.2013.14"><span class="nocase">Basic concepts in population modeling, simulation, and model-based drug development - Part 2: Introduction to pharmacokinetic modeling methods</span></a>. CPT: Pharmacometrics and Systems Pharmacology. 2013 Apr;2(4). </div>
</div>
<div id="ref-Upton2014" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Upton RN, Mould DR. <a href="https://doi.org/10.1038/PSP.2013.71"><span class="nocase">Basic concepts in population modeling, simulation, and model-based drug development: Part 3-introduction to pharmacodynamic modeling methods</span></a>. CPT: Pharmacometrics and Systems Pharmacology. 2014 Jan;3(1). </div>
</div>
<div id="ref-ette_pharmacometrics_2007" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Ette EI, Williams PJ. Pharmacometrics: The science of quantitative pharmacology. Wiley; 2007. </div>
</div>
<div id="ref-gabrielsson_pharmacokinetic_2007" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Gabrielsson J, Weiner D. Pharmacokinetic and <span>Pharmacodynamic</span> <span>Data</span> <span>Analysis</span>: <span>Concepts</span> and <span>Applications</span>, <span>Fourth</span> <span>Edition</span>. Taylor &amp; Francis; 2007. </div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Welcome</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./history.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">History</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Nonlinear mixed-effects modelling with nlmixr2 was written by Justin Wilkins, Matthew Fidler, William Denney, John Harrold, Richard Hooijmaaijers, Rik Schoemaker, Mirjam Trame, Yuan Xiong and Huijuan Xu.</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>